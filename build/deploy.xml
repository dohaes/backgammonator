<project name="Deploy Backgammonator" default="deploy" basedir=".">
	<!-- set global properties for this build -->
	<property name="tomcat" location="${TOMCAT_HOME}" />

	<import file="build.xml" />

	<target name="deploy" depends="distSample, distLib, distLibFull, distDeploy, clean" />

	<target name="distSample" depends="compile">
		<jar jarfile="${lib}/samplePlayers.jar" basedir="${build}" includes="sample/backgammonator/sample/player/protocol/**" />
	</target>

	<target name="distDeploy" depends="compile">
		<!-- move MySQL driver -->
		<copy todir="${tomcat}/common/lib">
			<fileset dir="${lib}" includes="mysql-connector.jar" />
		</copy>

		<!-- move used libraries -->
		<copy todir="${tomcat}/webapps/ROOT/WEB-INF/lib">
			<fileset dir="${lib}" includes="commons*.jar" />
		</copy>

		<!-- move backgammonator library -->
		<copy todir="${tomcat}/webapps/ROOT/WEB-INF/lib">
			<fileset dir="${lib}" includes="backgammonLibraryFull.jar" />
		</copy>
		<copy todir="${tomcat}/webapps/ROOT/res">
			<fileset dir="${lib}" includes="backgammonLibrary.jar" />
		</copy>
		<copy todir="${tomcat}/webapps/ROOT/res">
			<fileset dir="${lib}" includes="backgammonDemo.jar" />
		</copy>
		<copy todir="${tomcat}/webapps/ROOT/res">
			<fileset dir="${lib}" includes="samplePlayers.jar" />
		</copy>

		<!-- move web.xml -->
		<copy todir="${tomcat}/webapps/ROOT/WEB-INF">
			<fileset dir="${web}/WEB-INF" includes="*" />
		</copy>

		<!-- move jsps -->
		<copy todir="${tomcat}/webapps/ROOT">
			<fileset dir="${web}" includes="*.jsp" />
		</copy>

		<!-- move res -->
		<copy todir="${tomcat}/webapps/ROOT/res">
			<fileset dir="${res}" includes="*" />
		</copy>

		<!-- move properties -->
		<copy todir="${tomcat}">
			<fileset dir="${project.home}" includes="*.properties" />
		</copy>
	</target>

	<target name="cleanAll" depends="clean" description="clean up tomcat files and lib jars">
		<!-- Delete the jars in the lib -->
		<delete dir="${lib}" includes="backgammon* sample*" />

		<!-- Delete the tomcat files -->
		<delete dir="${tomcat}/webapps/ROOT" />
	</target>
</project>