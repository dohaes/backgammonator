<project name="Build Backgammonator" default="build" basedir=".">
	<!-- set global properties for this build -->
	<property name="project.home" location="../" />
	<property name="src" location="${project.home}/src" />
	<property name="lib" location="${project.home}/lib" />
	<property name="res" location="${project.home}/res" />
	<property name="web" location="${project.home}/web" />
	<property name="build" location="${project.home}/classes" />
	<property name="classpath" location="${lib}/servlet.jar:
		${lib}/commons-fileupload.jar:
		${lib}/commons-io.jar" />

	<target name="build" depends="distLib, distDemo, distSysLib, distWeb, distLibFull, clean" description="builds all jars"/>
	<target name="lib" depends="distLib" />
	<target name="demo" depends="distDemo" />
	<target name="syslib" depends="distSysLib" />
	<target name="web" depends="distWeb" />
	<target name="libfull" depends="distLibFull" />

	<target name="init">
		<!-- Create the time stamp -->
		<tstamp />
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${build}" />
		<!-- Create the distribution directory -->
		<mkdir dir="${lib}" />

		<copy todir="${build}">
			<fileset dir="../" includes="sample/**/*" />
		</copy>

	</target>

	<target name="compile" depends="init">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}:../sample/backgammonator/sample/players/interfacce/" destdir="${build}" classpath="${lib}/backgammonLibraryFull.jar" />
		<javac srcdir="${web}" destdir="${build}" classpath="${classpath}" />
	</target>

	<target name="distLib" depends="compile">
		<jar jarfile="${lib}/backgammonLibrary.jar" basedir="${build}" excludes="backgammonator/impl/protocol/*
							backgammonator/impl/game/Main.class" includes="backgammonator/**
			sample/backgammonator/sample/players/interfacce/**" />
	</target>

	<target name="distDemo" depends="compile">
		<jar jarfile="${lib}/backgammonDemo.jar" basedir="${build}" manifest="${src}/meta-inf/manifest.mf" includes="backgammonator/**
								sample/backgammonator/sample/player/protocol/**" />
	</target>

	<target name="distSysLib" depends="compile">
		<jar jarfile="${lib}/backgammonSysLib.jar" basedir="${build}" includes="
		  backgammonator/lib/tournament/*
          backgammonator/lib/game/*
          backgammonator/lib/logger/*
		  backgammonator/util/*" />
	</target>

	<target name="distWeb" depends="compile">
		<jar jarfile="${lib}/backgammonWeb.jar" basedir="${build}" includes="
		  backgammonator/impl/webinterface/*" />
	</target>

	<target name="distLibFull" depends="compile">
		<jar jarfile="${lib}/backgammonLibraryFull.jar" basedir="${build}" includes="backgammonator/**
								sample/backgammonator/sample/player/protocol/**
								sample/backgammonator/sample/players/interfacce/**
								" excludes="backgammonator/impl/game/Main.class" />
	</target>

	<target name="clean" description="clean up">
		<!-- Delete the ${build} directory trees -->
		<delete dir="${build}" />
	</target>
</project>